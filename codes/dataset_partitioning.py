#   训练集分割 2024-03-14 已完成
#   auther: KangWei
#   1. 从train_label.csv中随机选取40%的样本，存入test_label.csv
#   2. 将test_label中的文件移动到test文件夹
#   3. 从train_label.csv中删除test_label中的样本
#   4. 保存新的train_label.csv
#
#
import os
import random
import shutil
import pandas as pd


def divided_train_set():
    # 读取Label
    test_label = pd.read_csv('../data/raw_data/test_label.csv')


    # 将test_label中的存在的文件，从train文件夹中移动到test文件夹
    for file in test_label['filename']:
        shutil.move('../data/raw_data/train/pe/' + file, '../data/raw_data/test/pe/' + file)
        shutil.move('../data/raw_data/train/asm/' + file + '.asm', '../data/raw_data/test/asm/' + file + '.asm')

    print("文件移动完成")


def label_deduplication():
    # 读取Label
    train_label = pd.read_csv('../data/raw_data/train_label.csv')
    test_label = pd.read_csv('../data/raw_data/test/test_label.csv')

    # 把test_label中的文件名从train_label中删除
    train_label = train_label[~train_label['filename'].isin(test_label['filename'])]
    train_label.to_csv('data/raw_data/train_label.csv', index=False)


if __name__ == '__main__':
    divided_train_set()